<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The integration of single cell rank-based gene set enrichment analysis • irGSEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="The integration of single cell rank-based gene set enrichment analysis">
<meta property="og:description" content="The integration of single cell rank-based gene set enrichment analysis.
    Meanwhile, you are easy to visualize the results.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">irGSEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/chuiqin/irGSEA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="irgsea">irGSEA<a class="anchor" aria-label="anchor" href="#irgsea"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>Integrate all single cell rank-based gene set enrichment analysis and easy to visualize the results.</p>
<p>For more details, please view <a href="https://chuiqin.github.io/irGSEA/" class="external-link">irGSEA</a> And you can view <a href="https://www.jianshu.com/p/463dd6e2986f" class="external-link">Chinese tutorial</a></p>
<div class="section level2">
<h2 id="graph-abstrast">Graph Abstrast<a class="anchor" aria-label="anchor" href="#graph-abstrast"></a>
</h2>
<div class="figure">
<img src="./reference/figures/Abstrast.jpg" alt=""><p class="caption">Graph Abstrast</p>
</div>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># install packages from CRAN</span></span>
<span><span class="va">cran.packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aplot"</span>, <span class="st">"BiocManager"</span>, <span class="st">"data.table"</span>, <span class="st">"devtools"</span>, </span>
<span>                   <span class="st">"doParallel"</span>, <span class="st">"doRNG"</span>, <span class="st">"dplyr"</span>, <span class="st">"ggfun"</span>, <span class="st">"gghalves"</span>, </span>
<span>                   <span class="st">"ggplot2"</span>, <span class="st">"ggplotify"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggsci"</span>, <span class="st">"irlba"</span>,</span>
<span>                   <span class="st">"magrittr"</span>, <span class="st">"Matrix"</span>, <span class="st">"msigdbr"</span>, <span class="st">"pagoda2"</span>, <span class="st">"pointr"</span>, </span>
<span>                   <span class="st">"purrr"</span>, <span class="st">"RcppML"</span>, <span class="st">"readr"</span>, <span class="st">"reshape2"</span>, <span class="st">"reticulate"</span>, </span>
<span>                   <span class="st">"rlang"</span>, <span class="st">"RMTstat"</span>, <span class="st">"RobustRankAggreg"</span>, <span class="st">"roxygen2"</span>, </span>
<span>                   <span class="st">"Seurat"</span>, <span class="st">"SeuratObject"</span>, <span class="st">"stringr"</span>, <span class="st">"tibble"</span>, <span class="st">"tidyr"</span>, </span>
<span>                   <span class="st">"tidyselect"</span>, <span class="st">"tidytree"</span>, <span class="st">"VAM"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">cran.packages</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">i</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">i</span>, ask <span class="op">=</span> <span class="cn">F</span>, update <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># install packages from Bioconductor</span></span>
<span><span class="va">bioconductor.packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>, <span class="st">"BiocParallel"</span>, <span class="st">"ComplexHeatmap"</span>, </span>
<span>                           <span class="st">"decoupleR"</span>, <span class="st">"fgsea"</span>, <span class="st">"ggtree"</span>, <span class="st">"GSEABase"</span>, </span>
<span>                           <span class="st">"GSVA"</span>, <span class="st">"Nebulosa"</span>, <span class="st">"scde"</span>, <span class="st">"singscore"</span>,</span>
<span>                           <span class="st">"SummarizedExperiment"</span>, <span class="st">"UCell"</span>,</span>
<span>                           <span class="st">"viper"</span>,<span class="st">"sparseMatrixStats"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">bioconductor.packages</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">i</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">i</span>, ask <span class="op">=</span> <span class="cn">F</span>, update <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># install packages from Github</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"irGSEA"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"chuiqin/irGSEA"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Optional installation if you want to perform VISION, gficf, Sargent, ssGSEApy, GSVApy, etc</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#### install packages from Github</span></span>
<span><span class="co"># VISION</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"VISION"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"YosefLab/VISION"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># mdt need ranger</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ranger"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"imbs-hl/ranger"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># gficf need RcppML (version &gt; 0.3.7) package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"RcppML"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"0.3.7"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"The version of RcppML should greater than 0.3.7 and install RcppML package from Github"</span><span class="op">)</span></span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"zdebruine/RcppML"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># please first `library(RcppML)` if you want to perform gficf</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gficf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"gambalab/gficf"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># GSVApy and ssGSEApy need SeuratDisk package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"SeuratDisk"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mojaveazure/seurat-disk"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># sargent</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"sargent"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Sanofi-Public/PMCB-Sargent"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pagoda2 need scde package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"scde"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"hms-dbmi/scde"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># if error1 (functio 'sexp_as_cholmod_sparse' not provided by package 'Matrix')</span></span>
<span><span class="co"># or error2 (functio 'as_cholmod_sparse' not provided by package 'Matrix') occurs</span></span>
<span><span class="co"># when you perform pagoda2, please check the version of irlba and Matrix</span></span>
<span><span class="co"># It's ok when I test as follow：</span></span>
<span><span class="co"># R 4.2.2 irlba(v 2.3.5.1) Matrix(1.5-3)</span></span>
<span><span class="co"># R 4.3.1 irlba(v 2.3.5.1) Matrix(1.6-1.1)</span></span>
<span><span class="co"># R 4.3.2 irlba(v 2.3.5.1) Matrix(1.6-3)</span></span>
<span></span>
<span></span>
<span><span class="co">#### create conda env</span></span>
<span><span class="co"># If error (Unable to find conda binary. Is Anaconda installed) occurs, </span></span>
<span><span class="co"># please perform `reticulate::install_miniconda()`</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="st">"irGSEA"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_list</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_create</a></span><span class="op">(</span><span class="st">"irGSEA"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># if python package exist</span></span>
<span><span class="va">python.package</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_list_packages.html" class="external-link">py_list_packages</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"irGSEA"</span><span class="op">)</span><span class="op">$</span><span class="va">package</span></span>
<span><span class="va">require.package</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anndata"</span>, <span class="st">"scanpy"</span>, <span class="st">"argparse"</span>, <span class="st">"gseapy"</span>, <span class="st">"decoupler"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">require.package</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">python.package</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_install</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"irGSEA"</span>, packages <span class="op">=</span> <span class="va">i</span>, pip <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="some-users-can-accelerate-by-mirror">Some users can accelerate by mirror<a class="anchor" aria-label="anchor" href="#some-users-can-accelerate-by-mirror"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>BioC_mirror<span class="op">=</span><span class="st">"https://mirrors.tuna.tsinghua.edu.cn/bioconductor/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"repos"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CRAN<span class="op">=</span><span class="st">"http://mirrors.cloud.tencent.com/CRAN/"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># install packages from CRAN</span></span>
<span><span class="va">cran.packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aplot"</span>, <span class="st">"BiocManager"</span>, <span class="st">"data.table"</span>, <span class="st">"devtools"</span>, </span>
<span>                   <span class="st">"doParallel"</span>, <span class="st">"doRNG"</span>, <span class="st">"dplyr"</span>, <span class="st">"ggfun"</span>, <span class="st">"gghalves"</span>, </span>
<span>                   <span class="st">"ggplot2"</span>, <span class="st">"ggplotify"</span>, <span class="st">"ggridges"</span>, <span class="st">"ggsci"</span>, <span class="st">"irlba"</span>,</span>
<span>                   <span class="st">"magrittr"</span>, <span class="st">"Matrix"</span>, <span class="st">"msigdbr"</span>, <span class="st">"pagoda2"</span>, <span class="st">"pointr"</span>, </span>
<span>                   <span class="st">"purrr"</span>, <span class="st">"RcppML"</span>, <span class="st">"readr"</span>, <span class="st">"reshape2"</span>, <span class="st">"reticulate"</span>, </span>
<span>                   <span class="st">"rlang"</span>, <span class="st">"RMTstat"</span>, <span class="st">"RobustRankAggreg"</span>, <span class="st">"roxygen2"</span>, </span>
<span>                   <span class="st">"Seurat"</span>, <span class="st">"SeuratObject"</span>, <span class="st">"stringr"</span>, <span class="st">"tibble"</span>, <span class="st">"tidyr"</span>, </span>
<span>                   <span class="st">"tidyselect"</span>, <span class="st">"tidytree"</span>, <span class="st">"VAM"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">cran.packages</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">i</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">i</span>, ask <span class="op">=</span> <span class="cn">F</span>, update <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># install packages from Bioconductor</span></span>
<span><span class="va">bioconductor.packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>, <span class="st">"BiocParallel"</span>, <span class="st">"ComplexHeatmap"</span>, </span>
<span>                           <span class="st">"decoupleR"</span>, <span class="st">"fgsea"</span>, <span class="st">"ggtree"</span>, <span class="st">"GSEABase"</span>, </span>
<span>                           <span class="st">"GSVA"</span>, <span class="st">"Nebulosa"</span>, <span class="st">"scde"</span>, <span class="st">"singscore"</span>,</span>
<span>                           <span class="st">"SummarizedExperiment"</span>, <span class="st">"UCell"</span>, <span class="st">"viper"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">bioconductor.packages</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="va">i</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">i</span>, ask <span class="op">=</span> <span class="cn">F</span>, update <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># install packages from git</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"irGSEA"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/irGSEA.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># VISION</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"VISION"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/VISION.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># mdt need ranger</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ranger"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/ranger.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># gficf need RcppML (version &gt; 0.3.7) package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"RcppML"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="st">"0.3.7"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"The version of RcppML should greater than 0.3.7 and install RcppML package from Git"</span><span class="op">)</span></span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/RcppML.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># please first `library(RcppML)` if you want to perform gficf</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gficf"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/gficf.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># GSVApy and ssGSEApy need SeuratDisk package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"SeuratDisk"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/seurat-disk.git"</span>, </span>
<span>                          force <span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co"># sargent</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"sargent"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/PMCB-Sargent.git"</span>, </span>
<span>                          force <span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co"># pagoda2 need scde package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"scde"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_git.html" class="external-link">install_git</a></span><span class="op">(</span><span class="st">"https://gitee.com/fan_chuiqin/scde.git"</span>, force <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#### create conda env</span></span>
<span><span class="co"># If error (Unable to find conda binary. Is Anaconda installed) occurs, </span></span>
<span><span class="co"># please perform `reticulate::install_miniconda()`</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="st">"irGSEA"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_list</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_create</a></span><span class="op">(</span><span class="st">"irGSEA"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># if python package exist</span></span>
<span><span class="va">python.package</span> <span class="op">&lt;-</span> <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_list_packages.html" class="external-link">py_list_packages</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"irGSEA"</span><span class="op">)</span><span class="op">$</span><span class="va">package</span></span>
<span><span class="va">require.package</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anndata"</span>, <span class="st">"scanpy"</span>, <span class="st">"argparse"</span>, <span class="st">"gseapy"</span>, <span class="st">"decoupler"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">require.package</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">python.package</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/conda-tools.html" class="external-link">conda_install</a></span><span class="op">(</span>envname <span class="op">=</span> <span class="st">"irGSEA"</span>, packages <span class="op">=</span> <span class="va">i</span>, pip <span class="op">=</span> <span class="cn">T</span>,</span>
<span>     pip_options <span class="op">=</span> <span class="st">"-i https://pypi.tuna.tsinghua.edu.cn/simple"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-method">Available method<a class="anchor" aria-label="anchor" href="#available-method"></a>
</h2>
<div class="figure">
<img src="./reference/figures/figure3.png" alt=""><p class="caption">Available method</p>
</div>
</div>
<div class="section level2">
<h2 id="load-example-dataset">load example dataset<a class="anchor" aria-label="anchor" href="#load-example-dataset"></a>
</h2>
<p>load PBMC dataset by R package SeuratData</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># devtools::install_github('satijalab/seurat-data')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.satijalab.org/seurat" class="external-link">SeuratData</a></span><span class="op">)</span></span>
<span><span class="co"># view all available datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="https://satijalab.org/seurat/reference/AvailableData.html" class="external-link">AvailableData</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># download 3k PBMCs from 10X Genomics</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/InstallData.html" class="external-link">InstallData</a></span><span class="op">(</span><span class="st">"pbmc3k"</span><span class="op">)</span></span>
<span><span class="co"># the details of pbmc3k.final</span></span>
<span><span class="op">?</span><span class="va">pbmc3k.final</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.satijalab.org/seurat" class="external-link">SeuratData</a></span><span class="op">)</span></span>
<span><span class="co"># loading dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pbmc3k.final"</span><span class="op">)</span></span>
<span><span class="va">pbmc3k.final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/UpdateSeuratObject.html" class="external-link">UpdateSeuratObject</a></span><span class="op">(</span><span class="va">pbmc3k.final</span><span class="op">)</span></span>
<span><span class="co"># plot</span></span>
<span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">pbmc3k.final</span>, reduction <span class="op">=</span> <span class="st">"umap"</span>,</span>
<span>        group.by <span class="op">=</span> <span class="st">"seurat_annotations"</span>,label <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/SeuratTheme.html" class="external-link">NoLegend</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set cluster to idents</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/Idents.html" class="external-link">Idents</a></span><span class="op">(</span><span class="va">pbmc3k.final</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pbmc3k.final</span><span class="op">$</span><span class="va">seurat_annotations</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-library">Load library<a class="anchor" aria-label="anchor" href="#load-library"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chuiqin/irGSEA" class="external-link">irGSEA</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-enrichment-scores">Calculate enrichment scores<a class="anchor" aria-label="anchor" href="#calculate-enrichment-scores"></a>
</h2>
<p>calculate enrichment scores, return a Seurat object including these score matrix</p>
<p>AUcell or ssGSEA will run for a long time if there are lots of genes or cells. Thus, It’s recommended to keep high quality genes or cells.</p>
<p>Error (Valid ‘mctype’: ‘snow’ or ‘doMC’) occurs when ncore &gt; 1 : please ensure the version of AUCell &gt;= 1.14 or set ncore = 1.</p>
<p>It can be ignore when warnning occurs as follow: 1. closing unused connection 3 (localhost) 2. Using ‘dgCMatrix’ objects as input is still in an experimental stage. 3. xxx genes with constant expression values throuhgout the samples. 4. Some gene sets have size one. Consider setting ‘min.sz’ &gt; 1.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pbmc3k.final</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.score.html">irGSEA.score</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>, assay <span class="op">=</span> <span class="st">"RNA"</span>, </span>
<span>                             slot <span class="op">=</span> <span class="st">"data"</span>, seeds <span class="op">=</span> <span class="fl">123</span>, ncores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                             min.cells <span class="op">=</span> <span class="fl">3</span>, min.feature <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                             custom <span class="op">=</span> <span class="cn">F</span>, geneset <span class="op">=</span> <span class="cn">NULL</span>, msigdb <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                             species <span class="op">=</span> <span class="st">"Homo sapiens"</span>, category <span class="op">=</span> <span class="st">"H"</span>,  </span>
<span>                             subcategory <span class="op">=</span> <span class="cn">NULL</span>, geneid <span class="op">=</span> <span class="st">"symbol"</span>,</span>
<span>                             method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>, <span class="st">"UCell"</span>, <span class="st">"singscore"</span>, </span>
<span>                                        <span class="st">"ssgsea"</span>, <span class="st">"JASMINE"</span>, <span class="st">"viper"</span><span class="op">)</span>,</span>
<span>                             aucell.MaxRank <span class="op">=</span> <span class="cn">NULL</span>, ucell.MaxRank <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                             kcdf <span class="op">=</span> <span class="st">'Gaussian'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Validating object structure</span></span>
<span><span class="co">#&gt; Updating object slots</span></span>
<span><span class="co">#&gt; Ensuring keys are in the proper structure</span></span>
<span><span class="co">#&gt; Ensuring feature names don't have underscores or pipes</span></span>
<span><span class="co">#&gt; Object representation is consistent with the most current Seurat version</span></span>
<span><span class="co">#&gt; Calculate AUCell scores</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate AUCell scores</span></span>
<span><span class="co">#&gt; Calculate UCell scores</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate UCell scores</span></span>
<span><span class="co">#&gt; Calculate singscore scores</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate singscore scores</span></span>
<span><span class="co">#&gt; Calculate ssgsea scores</span></span>
<span><span class="co">#&gt; Warning in .local(expr, gset.idx.list, ...): Using 'dgCMatrix' objects as input</span></span>
<span><span class="co">#&gt; is still in an experimental stage.</span></span>
<span><span class="co">#&gt; Warning in .filterFeatures(expr, method): 1 genes with constant expression</span></span>
<span><span class="co">#&gt; values throuhgout the samples.</span></span>
<span><span class="co">#&gt; [1] "Calculating ranks..."</span></span>
<span><span class="co">#&gt; [1] "Calculating absolute values from ranks..."</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate ssgsea scores</span></span>
<span><span class="co">#&gt; Calculate JASMINE scores</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate jasmine scores</span></span>
<span><span class="co">#&gt; Calculate viper scores</span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span></span>
<span><span class="co">#&gt; Warning: Feature names cannot have underscores ('_'), replacing with dashes</span></span>
<span><span class="co">#&gt; ('-')</span></span>
<span><span class="co">#&gt; Finish calculate viper scores</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/ObjectAccess.html" class="external-link">Assays</a></span><span class="op">(</span><span class="va">pbmc3k.final</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "RNA"       "AUCell"    "UCell"     "singscore" "ssgsea"    "JASMINE"  </span></span>
<span><span class="co">#&gt; [7] "viper"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="integrate-differential-gene-set">Integrate differential gene set<a class="anchor" aria-label="anchor" href="#integrate-differential-gene-set"></a>
</h2>
<p>Wlicox test is perform to all enrichment score matrixes and gene sets with adjusted p value &lt; 0.05 are used to integrated through RRA. Among them, Gene sets with p value &lt; 0.05 are statistically significant and common differential in all gene sets enrichment analysis methods. All results are saved in a list.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.dge</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.integrate.html">irGSEA.integrate</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>, </span>
<span>                               group.by <span class="op">=</span> <span class="st">"seurat_annotations"</span>,</span>
<span>                               metadata <span class="op">=</span> <span class="cn">NULL</span>, col.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                               method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>,<span class="st">"UCell"</span>,<span class="st">"singscore"</span>,</span>
<span>                                          <span class="st">"ssgsea"</span>, <span class="st">"JASMINE"</span>, <span class="st">"viper"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculate differential gene set : AUCell</span></span>
<span><span class="co">#&gt; Calculate differential gene set : UCell</span></span>
<span><span class="co">#&gt; Calculate differential gene set : singscore</span></span>
<span><span class="co">#&gt; Calculate differential gene set : ssgsea</span></span>
<span><span class="co">#&gt; Calculate differential gene set : JASMINE</span></span>
<span><span class="co">#&gt; Calculate differential gene set : viper</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">result.dge</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<div class="section level3">
<h3 id="id_1-global-show">1. Global show<a class="anchor" aria-label="anchor" href="#id_1-global-show"></a>
</h3>
</div>
<div class="section level3">
<h3 id="heatmap-plot">heatmap plot<a class="anchor" aria-label="anchor" href="#heatmap-plot"></a>
</h3>
<p>Show co-upregulated or co-downregulated gene sets per cluster in RRA</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irGSEA.heatmap.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.heatmap.html">irGSEA.heatmap</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">result.dge</span>, </span>
<span>                                      method <span class="op">=</span> <span class="st">"RRA"</span>,</span>
<span>                                      top <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                                      show.geneset <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="va">irGSEA.heatmap.plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="bubbleplot">Bubble.plot<a class="anchor" aria-label="anchor" href="#bubbleplot"></a>
</h3>
<p>Show co-upregulated or co-downregulated gene sets per cluster in RRA.</p>
<p>If error (argument “caller_env” is missing, with no default) occurs : please uninstall ggtree and run “remotes::install_github(”YuLab-SMU/ggtree”)“.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irGSEA.bubble.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.bubble.html">irGSEA.bubble</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">result.dge</span>, </span>
<span>                                    method <span class="op">=</span> <span class="st">"RRA"</span>, </span>
<span>                                    top <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">irGSEA.bubble.plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="upset-plot">upset plot<a class="anchor" aria-label="anchor" href="#upset-plot"></a>
</h3>
<p>Show the intersections of significant gene sets among clusters in RRA</p>
<p>Don’t worry if warning happens : the condition has length &gt; 1 and only the first element will be used. It’s ok.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irGSEA.upset.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.upset.html">irGSEA.upset</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">result.dge</span>, </span>
<span>                                  method <span class="op">=</span> <span class="st">"RRA"</span><span class="op">)</span></span>
<span><span class="va">irGSEA.upset.plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="stacked-bar-plot">Stacked bar plot<a class="anchor" aria-label="anchor" href="#stacked-bar-plot"></a>
</h3>
<p>Show the intersections of significant gene sets among clusters in all methods</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">irGSEA.barplot.plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.barplot.html">irGSEA.barplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">result.dge</span>,</span>
<span>                                      method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>, <span class="st">"UCell"</span>, <span class="st">"singscore"</span>,</span>
<span>                                                 <span class="st">"ssgsea"</span>, <span class="st">"JASMINE"</span>, <span class="st">"viper"</span>, <span class="st">"RRA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">irGSEA.barplot.plot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="id_2-local-show">2. local show<a class="anchor" aria-label="anchor" href="#id_2-local-show"></a>
</h3>
<p>Show the expression and distribution of special gene sets in special gene set enrichment analysis method</p>
</div>
<div class="section level3">
<h3 id="density-scatterplot">density scatterplot<a class="anchor" aria-label="anchor" href="#density-scatterplot"></a>
</h3>
<p>Show the expression and distribution of “HALLMARK-INFLAMMATORY-RESPONSE” in Ucell on UMAP plot.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scatterplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.density.scatterplot.html">irGSEA.density.scatterplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>,</span>
<span>                             method <span class="op">=</span> <span class="st">"UCell"</span>,</span>
<span>                             show.geneset <span class="op">=</span> <span class="st">"HALLMARK-INFLAMMATORY-RESPONSE"</span>,</span>
<span>                             reduction <span class="op">=</span> <span class="st">"umap"</span><span class="op">)</span></span>
<span><span class="va">scatterplot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="half-vlnplot">half vlnplot<a class="anchor" aria-label="anchor" href="#half-vlnplot"></a>
</h3>
<p>Show the expression and distribution of “HALLMARK-INFLAMMATORY-RESPONSE” in Ucell among clusters.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">halfvlnplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.halfvlnplot.html">irGSEA.halfvlnplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>,</span>
<span>                                  method <span class="op">=</span> <span class="st">"UCell"</span>,</span>
<span>                                  show.geneset <span class="op">=</span> <span class="st">"HALLMARK-INFLAMMATORY-RESPONSE"</span><span class="op">)</span></span>
<span><span class="va">halfvlnplot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="100%"></p>
<p>Show the expression and distribution of “HALLMARK-INFLAMMATORY-RESPONSE” between AUCell, UCell, singscore, ssgsea, JASMINE and viper among clusters.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vlnplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.vlnplot.html">irGSEA.vlnplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>,</span>
<span>                          method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCell"</span>, <span class="st">"UCell"</span>, <span class="st">"singscore"</span>, <span class="st">"ssgsea"</span>, </span>
<span>                                     <span class="st">"JASMINE"</span>, <span class="st">"viper"</span><span class="op">)</span>,</span>
<span>                          show.geneset <span class="op">=</span> <span class="st">"HALLMARK-INFLAMMATORY-RESPONSE"</span><span class="op">)</span></span>
<span><span class="va">vlnplot</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="ridge-plot">ridge plot<a class="anchor" aria-label="anchor" href="#ridge-plot"></a>
</h3>
<p>Show the expression and distribution of “HALLMARK-INFLAMMATORY-RESPONSE” in Ucell among clusters.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ridgeplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.ridgeplot.html">irGSEA.ridgeplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"UCell"</span>,</span>
<span>                              show.geneset <span class="op">=</span> <span class="st">"HALLMARK-INFLAMMATORY-RESPONSE"</span><span class="op">)</span></span>
<span><span class="va">ridgeplot</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 0.00533</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="density-heatmap">density heatmap<a class="anchor" aria-label="anchor" href="#density-heatmap"></a>
</h3>
<p>Show the expression and distribution of “HALLMARK-INFLAMMATORY-RESPONSE” in Ucell among clusters.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">densityheatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/irGSEA.densityheatmap.html">irGSEA.densityheatmap</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pbmc3k.final</span>,</span>
<span>                                        method <span class="op">=</span> <span class="st">"UCell"</span>,</span>
<span>                                        show.geneset <span class="op">=</span> <span class="st">"HALLMARK-INFLAMMATORY-RESPONSE"</span><span class="op">)</span></span>
<span><span class="va">densityheatmap</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="work-with-clusterprofiler-package">Work with clusterProfiler package<a class="anchor" aria-label="anchor" href="#work-with-clusterprofiler-package"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### work with clusterProfiler package ####</span></span>
<span><span class="co"># load library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">### kegg ###</span></span>
<span><span class="co"># download kegg pathway (human) and write as gson file</span></span>
<span><span class="va">kk</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/gson_KEGG.html" class="external-link">gson_KEGG</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"hsa"</span><span class="op">)</span></span>
<span><span class="fu">gson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gson/man/IO.html" class="external-link">write.gson</a></span><span class="op">(</span><span class="va">kk</span>, file <span class="op">=</span> <span class="st">"./KEGG_20231128.gson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read gson file</span></span>
<span><span class="va">kk2</span> <span class="op">&lt;-</span> <span class="fu">gson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gson/man/IO.html" class="external-link">read.gson</a></span><span class="op">(</span><span class="st">"./KEGG_20231123.gson"</span><span class="op">)</span></span>
<span><span class="co"># Convert to a data frame</span></span>
<span><span class="va">kegg.list</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">kk2</span><span class="op">@</span><span class="va">gsid2name</span>,</span>
<span>                              <span class="va">kk2</span><span class="op">@</span><span class="va">gsid2gene</span>,</span>
<span>                              by <span class="op">=</span> <span class="st">"gsid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">)</span></span>
<span><span class="co"># gsid               name      gene</span></span>
<span><span class="co"># 1 hsa01100 Metabolic pathways        10</span></span>
<span><span class="co"># 2 hsa01100 Metabolic pathways       100</span></span>
<span><span class="co"># 3 hsa01100 Metabolic pathways     10005</span></span>
<span><span class="co"># 4 hsa01100 Metabolic pathways     10007</span></span>
<span><span class="co"># 5 hsa01100 Metabolic pathways 100137049</span></span>
<span><span class="co"># 6 hsa01100 Metabolic pathways     10020</span></span>
<span></span>
<span><span class="co"># Convert gene ID to gene symbol</span></span>
<span><span class="va">gene_name</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/bitr.html" class="external-link">bitr</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">$</span><span class="va">gene</span>, </span>
<span>                                   fromType <span class="op">=</span> <span class="st">"ENTREZID"</span>, </span>
<span>                                   toType <span class="op">=</span> <span class="st">"SYMBOL"</span>, </span>
<span>                                   OrgDb <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span><span class="op">)</span></span>
<span><span class="va">kegg.list</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">kegg.list</span>,</span>
<span>                              <span class="va">gene_name</span>,</span>
<span>                              by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span><span class="op">=</span><span class="st">"ENTREZID"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># remove NA value if exist</span></span>
<span><span class="va">kegg.list</span> <span class="op">&lt;-</span> <span class="va">kegg.list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"SYMBOL"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">)</span></span>
<span><span class="co"># gsid               name      gene  SYMBOL</span></span>
<span><span class="co"># 1 hsa01100 Metabolic pathways        10    NAT2</span></span>
<span><span class="co"># 2 hsa01100 Metabolic pathways       100     ADA</span></span>
<span><span class="co"># 3 hsa01100 Metabolic pathways     10005   ACOT8</span></span>
<span><span class="co"># 4 hsa01100 Metabolic pathways     10007  GNPDA1</span></span>
<span><span class="co"># 5 hsa01100 Metabolic pathways 100137049 PLA2G4B</span></span>
<span><span class="co"># 6 hsa01100 Metabolic pathways     10020     GNE</span></span>
<span></span>
<span><span class="co"># convert to list required by irGSEA package</span></span>
<span><span class="va">kegg.list</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">kegg.list</span> <span class="op">&lt;-</span> <span class="va">kegg.list</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">name</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">SYMBOL</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kegg.list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### go bp ###</span></span>
<span><span class="co"># download go bp (human) and write as gson file</span></span>
<span><span class="va">go</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/gson_GO.html" class="external-link">gson_GO</a></span><span class="op">(</span>OrgDb <span class="op">=</span> <span class="st">"org.Hs.eg.db"</span>, ont <span class="op">=</span> <span class="st">"BP"</span><span class="op">)</span></span>
<span><span class="fu">gson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gson/man/IO.html" class="external-link">write.gson</a></span><span class="op">(</span><span class="va">go</span>, file <span class="op">=</span> <span class="st">"./go_20231128.gson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># read gson file</span></span>
<span><span class="va">go2</span> <span class="op">&lt;-</span> <span class="fu">gson</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gson/man/IO.html" class="external-link">read.gson</a></span><span class="op">(</span><span class="st">"./go_20231128.gson"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to a data frame</span></span>
<span><span class="va">go.list</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">go2</span><span class="op">@</span><span class="va">gsid2name</span>,</span>
<span>                            <span class="va">go2</span><span class="op">@</span><span class="va">gsid2gene</span>,</span>
<span>                            by <span class="op">=</span> <span class="st">"gsid"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">)</span></span>
<span><span class="co"># gsid                             name gene</span></span>
<span><span class="co"># 1 GO:0000001        mitochondrion inheritance &lt;NA&gt;</span></span>
<span><span class="co">#   2 GO:0000002 mitochondrial genome maintenance  142</span></span>
<span><span class="co"># 3 GO:0000002 mitochondrial genome maintenance  291</span></span>
<span><span class="co"># 4 GO:0000002 mitochondrial genome maintenance 1763</span></span>
<span><span class="co"># 5 GO:0000002 mitochondrial genome maintenance 1890</span></span>
<span><span class="co"># 6 GO:0000002 mitochondrial genome maintenance 2021</span></span>
<span></span>
<span><span class="co"># Convert gene ID to gene symbol</span></span>
<span><span class="va">go.list</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">go.list</span>,</span>
<span>                            <span class="va">go2</span><span class="op">@</span><span class="va">gene2name</span>,</span>
<span>                            by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span><span class="op">=</span><span class="st">"ENTREZID"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># remove NA value if exist</span></span>
<span><span class="va">go.list</span> <span class="op">&lt;-</span> <span class="va">go.list</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="st">"SYMBOL"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">)</span></span>
<span><span class="co"># gsid                             name gene  SYMBOL</span></span>
<span><span class="co"># 2 GO:0000002 mitochondrial genome maintenance  142   PARP1</span></span>
<span><span class="co"># 3 GO:0000002 mitochondrial genome maintenance  291 SLC25A4</span></span>
<span><span class="co"># 4 GO:0000002 mitochondrial genome maintenance 1763    DNA2</span></span>
<span><span class="co"># 5 GO:0000002 mitochondrial genome maintenance 1890    TYMP</span></span>
<span><span class="co"># 6 GO:0000002 mitochondrial genome maintenance 2021   ENDOG</span></span>
<span><span class="co"># 7 GO:0000002 mitochondrial genome maintenance 3980    LIG3</span></span>
<span></span>
<span><span class="co"># convert to list required by irGSEA package</span></span>
<span><span class="va">go.list</span><span class="op">$</span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">go.list</span> <span class="op">&lt;-</span> <span class="va">go.list</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">name</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">SYMBOL</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">go.list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="work-with-newest-msigdb">Work with newest Msigdb<a class="anchor" aria-label="anchor" href="#work-with-newest-msigdb"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### work with newest Msigdb ####</span></span>
<span></span>
<span><span class="co"># https://data.broadinstitute.org/gsea-msigdb/msigdb/release/</span></span>
<span><span class="co"># In this page, you can download human/mouse gmt file or db.zip file</span></span>
<span><span class="co"># The db.zip file contains metadata information for the gene set</span></span>
<span></span>
<span><span class="co"># load library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/" class="external-link">clusterProfiler</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org" class="external-link">RSQLite</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">### db.zip ###</span></span>
<span></span>
<span><span class="co"># download zip file and unzip zip file</span></span>
<span><span class="va">zip_url</span> <span class="op">&lt;-</span> <span class="st">"https://data.broadinstitute.org/gsea-msigdb/msigdb/release/2023.2.Hs/msigdb_v2023.2.Hs.db.zip"</span></span>
<span><span class="va">local_zip_path</span> <span class="op">&lt;-</span> <span class="st">"./msigdb_v2023.2.Hs.db.zip"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">zip_url</span>, <span class="va">local_zip_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="va">local_zip_path</span>, exdir <span class="op">=</span> <span class="st">"./"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># code modified by https://rdrr.io/github/cashoes/sear/src/data-raw/1_parse_msigdb_sqlite.r</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span>, dbname <span class="op">=</span> <span class="st">'./msigdb_v2023.2.Hs.db'</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html" class="external-link">dbListTables</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define tables we want to combine</span></span>
<span><span class="va">geneset_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'gene_set'</span><span class="op">)</span>                                              <span class="co"># standard_name, collection_name</span></span>
<span><span class="va">details_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'gene_set_details'</span><span class="op">)</span>                                      <span class="co"># description_brief, description_full</span></span>
<span><span class="va">geneset_genesymbol_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'gene_set_gene_symbol'</span><span class="op">)</span>                       <span class="co"># meat and potatoes</span></span>
<span><span class="va">genesymbol_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'gene_symbol'</span><span class="op">)</span>                                        <span class="co"># mapping from ids to gene symbols</span></span>
<span><span class="va">collection_db</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">'collection'</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">collection_name</span>, <span class="va">full_name</span><span class="op">)</span>  <span class="co"># collection metadata</span></span>
<span></span>
<span><span class="co"># join tables</span></span>
<span><span class="va">msigdb</span> <span class="op">&lt;-</span> <span class="va">geneset_db</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">details_db</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span> <span class="op">=</span> <span class="st">'gene_set_id'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">collection_db</span>, by <span class="op">=</span> <span class="st">'collection_name'</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">geneset_genesymbol_db</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'id'</span> <span class="op">=</span> <span class="st">'gene_set_id'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">genesymbol_db</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gene_symbol_id'</span> <span class="op">=</span> <span class="st">'id'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span>collection <span class="op">=</span> <span class="va">collection_name</span>, subcollection <span class="op">=</span> <span class="va">full_name</span>, geneset <span class="op">=</span> <span class="va">standard_name</span>, description <span class="op">=</span> <span class="va">description_brief</span>, <span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># clean up</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">msigdb</span><span class="op">$</span><span class="va">collection</span><span class="op">)</span></span>
<span><span class="co"># [1] "C1"                 "C2:CGP"             "C2:CP:BIOCARTA"    </span></span>
<span><span class="co"># [4] "C2:CP:KEGG_LEGACY"  "C2:CP:PID"          "C3:MIR:MIRDB"      </span></span>
<span><span class="co"># [7] "C3:MIR:MIR_LEGACY"  "C3:TFT:GTRD"        "C3:TFT:TFT_LEGACY" </span></span>
<span><span class="co"># [10] "C4:3CA"             "C4:CGN"             "C4:CM"             </span></span>
<span><span class="co"># [13] "C6"                 "C7:IMMUNESIGDB"     "C7:VAX"            </span></span>
<span><span class="co"># [16] "C8"                 "C5:GO:BP"           "C5:GO:CC"          </span></span>
<span><span class="co"># [19] "C5:GO:MF"           "H"                  "C5:HPO"            </span></span>
<span><span class="co"># [22] "C2:CP:KEGG_MEDICUS" "C2:CP:REACTOME"     "C2:CP:WIKIPATHWAYS"</span></span>
<span><span class="co"># [25] "C2:CP" </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">msigdb</span><span class="op">$</span><span class="va">subcollection</span><span class="op">)</span></span>
<span><span class="co"># [1] "C1"                 "C2:CGP"             "C2:CP:BIOCARTA"    </span></span>
<span><span class="co"># [4] "C2:CP:KEGG_LEGACY"  "C2:CP:PID"          "C3:MIR:MIRDB"      </span></span>
<span><span class="co"># [7] "C3:MIR:MIR_LEGACY"  "C3:TFT:GTRD"        "C3:TFT:TFT_LEGACY" </span></span>
<span><span class="co"># [10] "C4:3CA"             "C4:CGN"             "C4:CM"             </span></span>
<span><span class="co"># [13] "C6"                 "C7:IMMUNESIGDB"     "C7:VAX"            </span></span>
<span><span class="co"># [16] "C8"                 "C5:GO:BP"           "C5:GO:CC"          </span></span>
<span><span class="co"># [19] "C5:GO:MF"           "H"                  "C5:HPO"            </span></span>
<span><span class="co"># [22] "C2:CP:KEGG_MEDICUS" "C2:CP:REACTOME"     "C2:CP:WIKIPATHWAYS"</span></span>
<span><span class="co"># [25] "C2:CP" </span></span>
<span></span>
<span><span class="co"># convert to list[hallmarker] required by irGSEA package</span></span>
<span><span class="va">msigdb.h</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">collection</span><span class="op">==</span><span class="st">"H"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneset"</span>, <span class="st">"symbol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">geneset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span></span>
<span><span class="va">msigdb.h</span> <span class="op">&lt;-</span> <span class="va">msigdb.h</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">geneset</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to list[go bp] required by irGSEA package</span></span>
<span><span class="va">msigdb.go.bp</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">collection</span><span class="op">==</span><span class="st">"C5:GO:BP"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneset"</span>, <span class="st">"symbol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">geneset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span></span>
<span><span class="va">msigdb.go.bp</span> <span class="op">&lt;-</span> <span class="va">msigdb.go.bp</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">geneset</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to list[KEGG] required by irGSEA package</span></span>
<span><span class="va">msigdb.kegg</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">collection</span><span class="op">==</span><span class="st">"C2:CP:KEGG_MEDICUS"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneset"</span>, <span class="st">"symbol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">geneset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span></span>
<span><span class="va">msigdb.kegg</span> <span class="op">&lt;-</span> <span class="va">msigdb.kegg</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">geneset</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Look for the gene sets associated with angiogenesis from gene sets names and </span></span>
<span><span class="co"># gene sets descriptions</span></span>
<span></span>
<span><span class="va">category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"angiogenesis"</span>, <span class="st">"vessel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msigdb.vessel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">category</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Ignore case matching</span></span>
<span>  <span class="va">find.index.description</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">msigdb</span><span class="op">$</span><span class="va">description</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stringr/man/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, ignore_case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">find.index.name</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">msigdb</span><span class="op">$</span><span class="va">geneset</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stringr/man/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, ignore_case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">msigdb.vessel</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">msigdb</span><span class="op">[</span><span class="va">find.index.description</span> <span class="op">|</span> <span class="va">find.index.name</span>, <span class="op">]</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span><span class="va">msigdb.vessel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">msigdb.vessel</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">msigdb.vessel</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 6 × 6</span></span>
<span><span class="co"># collection subcollection                      geneset            description    symbol category</span></span>
<span><span class="co"># &lt;chr&gt;      &lt;chr&gt;                              &lt;chr&gt;              &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;   </span></span>
<span><span class="co">#   1 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … HECW1  angioge…</span></span>
<span><span class="co"># 2 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … JADE2  angioge…</span></span>
<span><span class="co"># 3 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … SEMA3C angioge…</span></span>
<span><span class="co"># 4 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … STUB1  angioge…</span></span>
<span><span class="co"># 5 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … FAH    angioge…</span></span>
<span><span class="co"># 6 C2:CGP     Chemical and Genetic Perturbations HU_ANGIOGENESIS_UP Up-regulated … COL7A1 angioge…</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">msigdb.vessel</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 112</span></span>
<span></span>
<span><span class="co"># convert gene sets associated with angiogenesis to list </span></span>
<span><span class="co"># required by irGSEA package</span></span>
<span><span class="va">msigdb.vessel</span> <span class="op">&lt;-</span> <span class="va">msigdb.vessel</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geneset"</span>, <span class="st">"symbol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.vessel</span><span class="op">$</span><span class="va">geneset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.vessel</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span></span>
<span><span class="va">msigdb.vessel</span> <span class="op">&lt;-</span> <span class="va">msigdb.vessel</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">geneset</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.vessel</span><span class="op">$</span><span class="va">geneset</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">### gmt file ###</span></span>
<span></span>
<span><span class="co"># download gmt file</span></span>
<span><span class="va">gmt_url</span> <span class="op">&lt;-</span> <span class="st">"https://data.broadinstitute.org/gsea-msigdb/msigdb/release/2023.2.Hs/msigdb.v2023.2.Hs.symbols.gmt"</span></span>
<span><span class="va">local_gmt</span> <span class="op">&lt;-</span> <span class="st">"./msigdb.v2023.2.Hs.symbols.gmt"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">gmt_url</span> , <span class="va">local_gmt</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msigdb</span> <span class="op">&lt;-</span> <span class="fu">clusterProfiler</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gson/man/read-gmt.html" class="external-link">read.gmt</a></span><span class="op">(</span><span class="st">"./msigdb.v2023.2.Hs.symbols.gmt"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to list[hallmarker] required by irGSEA package</span></span>
<span><span class="va">msigdb.h</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stringr/man/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="st">"HALLMARK_"</span>, ignore_case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">msigdb.h</span> <span class="op">&lt;-</span> <span class="va">msigdb.h</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">term</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.h</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to list[go bp] required by irGSEA package</span></span>
<span></span>
<span><span class="va">msigdb.go.bp</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stringr/man/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="st">"GOBP_"</span>, ignore_case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">msigdb.go.bp</span> <span class="op">&lt;-</span> <span class="va">msigdb.go.bp</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">term</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.go.bp</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert to list[KEGG] required by irGSEA package</span></span>
<span><span class="va">msigdb.kegg</span> <span class="op">&lt;-</span> <span class="va">msigdb</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">term</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/stringr/man/modifiers.html" class="external-link">regex</a></span><span class="op">(</span><span class="st">"KEGG_"</span>, ignore_case<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">term</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">term</span><span class="op">)</span></span>
<span><span class="va">msigdb.kegg</span> <span class="op">&lt;-</span> <span class="va">msigdb.kegg</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">term</span>, .keep <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span> <span class="op">~</span><span class="va">.x</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rlang/man/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">msigdb.kegg</span><span class="op">$</span><span class="va">term</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/chuiqin/irGSEA/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/chuiqin/irGSEA/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing irGSEA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Chuiqin Fan <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Chuiqin Fan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
